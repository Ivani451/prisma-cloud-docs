== Alibaba Cloud Kubernetes does not install plugin Terway or Flannel to support standard policies


*Policy Details* 

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| b1622f63-3d01-4550-9d35-6946c08f36e7

|Checkov Check ID 
| https://github.com/bridgecrewio/checkov/tree/master/checkov/terraform/checks/resource/alicloud/K8sEnableNetworkPolicies.py[CKV_ALI_26]

|Severity
|LOW

|Subtype
|Build

|Frameworks
|Terraform

|=== 



*Description* 


Installing the Terway or Flannel plugin on an Alibaba Cloud Kubernetes cluster can help to support standard policies for network communication and routing.
Both Terway and Flannel are network plugins that can be used to provide network connectivity and communication between pods in a Kubernetes cluster.
Terway is a network plugin developed by Alibaba Cloud that is optimized for use with Alibaba Cloud Container Service for Kubernetes.
It provides high-performance and low-latency network connectivity for Kubernetes clusters running on Alibaba Cloud.

=== Fix - Buildtime


*Terraform* 




[source,go]
----
{
  "codes": [
    {
      "code": "resource "alicloud_cs_kubernetes" "pass" {
  worker_number         = 4
  worker_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]
  worker_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]

  addons {
    config = ""
    name   = "terway-eniip"
  }

  pod_vswitch_ids = ["vsw-id4"]
}

# array of addons
resource "alicloud_cs_kubernetes" "pass2" {
  worker_number         = 4
  worker_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]
  worker_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]

  addons {
    config = ""
    name   = "flannel"
  }

  addons {
    name   = "csi-plugin"
    config = ""
  }

  pod_cidr = "10.0.1.0/16"
}
",
      "language": "go"
    }
  ]
}
----
