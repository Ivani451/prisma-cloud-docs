== GitHub Actions ACTIONS_ALLOW_UNSECURE_COMMANDS environment variable is set to true


*Policy Details* 

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| 5f535c28-9737-46eb-b505-0471b746c202

|Checkov Check ID 
| https://github.com/bridgecrewio/checkov/tree/master/checkov/github_actions/checks/job/AllowUnsecureCommandsOnJob.py[CKV_GHA_1]

|Severity
|MEDIUM

|Subtype
|Build

|Frameworks
|GithubAction

|=== 



*Description* 


GitHub Actions has an environment variable flag called `ACTIONS_ALLOW_UNSECURE_COMMANDS` that allows GHA workflows to run deprecated commands `set-env` and `add-path`.
These are vulnerable commands that should not be used as they expose accounts to potential credential theft or code injection.

=== Fix - Buildtime


*GitHub Actions* 


Remove `ACTIONS_ALLOW_UNSECURE_COMMANDS: 'true'`
[,yaml]
----

...
env:
-          ACTIONS_ALLOW_UNSECURE_COMMANDS: 'true'

...
----
